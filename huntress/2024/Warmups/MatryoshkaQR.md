# MatryoshkaQR

Wow! This is a **_big_** QR code! I wonder what it says...?

File: [qrcode.png](obsidian://open?vault=capturetheflags&file=huntress%2F2024%2FWarmups%2Fchallenge-files%2Fqrcode.png)

-----

Opening the `qrcode.png` file in [CyberChef](https://gchq.github.io/CyberChef/#recipe=Parse_QR_Code(false)&input=iVBORw0KGgoAAAANSUhEUgAAAoQAAAKEAQAAAAC2zBbiAAARUklEQVR4nO2dTXIkx46Evd4FvG6g%2Bx%2Brb%2BB1Ap/F55HsWc1iRJuhBWmSWk1WpylhiADgP9Cr%2Bne/Pv/5lx8o/T7x94m/T/x94v/RE1%2Bv1/v1eb8%2Beuv9%2Brw%2Bb%2Bn1ekkfvd8fSR%2B99dLn/Xrp/Xnrpdfr8xGfeOmlz/ujlz56vV7vH/PW//ZX69ZVrMS1lVZS4siOG1mV27qp5EppnFZpmqpKZLdufsJbf08cZTeKlFZu6kZqq0RNWqmW5ahpVcmSbMeqqsrJHvQT3vrb4uhUVqI6KvFpJEutLKtxU3Kusr3vp1Vktf6NoxOOrN1IHNlUtiVC17aK5MaNOeKy6xLF33xsHbtRJamu00h2FLmWw3WpcoGq3IuuIqmqol59P76qF7fd//7rIzmXzjPixCZS2qrLOVWyq7iOlK6wVKaoNIlrNU1U0rG9NR/V1rLk1HYUS6rahIaIH1VUcZmyXmcXZFy3lUWl/wlv/T1xTFspVSo5TUoVbiWrEo0itaaJHKf8XIrtSKrim/NRlS2qcKjTUWqlrlxndYijfBJYtm05JlnpMe%2BOY5ooaU0v6DiSbKtpGyVRXNexVYc%2ByKq0cp0oV%2Bdj%2BDX8PnVCM964UklSyomcWHFlV2ptNyYh774f7cSJHakSv7frhG4xqSzRN0oKx1opn9JqjO6u18km56gK013tyHVkbWAJ35IdRkDVdhtux7rW3fdjkl12dlJnwENUp4m9qTGtnDZpks2JivZd%2BepzLVtupDjmdnS9brFRa7pxSkuctE1jqYnPlCjl7vk6amxnSKNAGingAS4D9Umqps2aoVqKVcbK%2BO44ys/4Etn2jqztDSqKHafKeklZzwdEsbZyef94LjxJNIdyGBMbK2nSUsEtSnka82eYtr%2BmnovjqFaNzSRogYitEXIbNTSMWldEhUk0eLxfmPjFcfS5EL2CY2ZsxRIHVokJVoZ72xW9T8SYGPvuPhwgnBpdSIXYVhzDaDH7uZbC2GK7lgs9Y8ab3I2Hn2CklpwEimZJKSgHzrsUhu0GCkwKWapG8d3zjEBsZAeaQU0PwmPFSh%2B0RyWyiaKDpYF2KFfXayUklkxpzrqYxoYIrCWldOCqkkFnZLLCUHP3fO3Gcp0kiRtHSSARV4NaF2b7pOJCrPIJ/87XWWNjF7aG/HIE4CMP9Rkc1AKH0/3sj6sGT7s4jvXAMoQTJGVyosoELTsGESqyCg/NTTZS6u7%2BEdzWit0ODI8MocXk56ZrE5XYBU4rQFAkSdlo%2BRPe%2Brvy0R4u/kzMoQdqmQzbnMFRjNiWXYOx1fTod8/XBvZCRcFUDSIxRiHREZ9osFoOZJn1jvSPl5/riFOsuhpNgCglPdKyOm6n9jGcIhq%2Blkmo0uV1Ju4YBaUcV7uIerxxUQgpiFuqRW3EK%2BW6d%2BPhtgEPmzgCOusKdOFhwHmbNY0w18R796Nj%2B%2Br5WnI3vsDtowuQJtITZExBJkB6mxxWlqcEWuzm%2B5FQ5MzN0kk3WFZRTUhcyfqSPIq2fNOOQCt/wlt/T52B7Wu9CdmiqRnjz7jXjDdAHtndlihYah0A7d44TiwqNc/fJN9hqrkexzX4pCW8DX3jJEJXx9GeeA/dvCGyanQB5WbMwgR701DONXlFdolefT%2Bub0QreuCdDHNknhGNd87P0KlQxwvDM6Lm4jg2iMm0aKEJiDHJUIE4tTFIbjRaQWJUbKUAF90bR0UoUiLQCgjVqSUYog164XBpytP0DX9cgvrqeaZGoYx6rEssZezWo6ZQEiTMkF8d2LP7sdbFfgV12CzgbJXKQVwrlb68g2mfMXoiM07y5kM0qDfH0VTkHdDAviQwsAWbVCeR7NxecuCuN5kTzZvj6G5kIdmITB1zXZJ3BM%2BdPG80V6sFVb5eH%2B6Hi0ZiyzQdy0FIVjQBjhVlfBgo5JHlc1fe3T9OyAhjEAmedQZhbsgjW6Yt8ppue7xrOzzt6jh6stB49g6AXRxInm5KkbEs4PTii1jbx6d0dd%2BTmQ2wuIXGG0ycn7hNskkbyZR3Q05oxrh9Oz/T0m6v/ekMCY9VzjF%2BfwbEQWrzFZ6/q9vP9ej8w6riXbesMKGcPO1ysRhEgtJ0tyN6iqvnwnkGAcE4nvF4BUfUZxBy0DVo1hwT7NGH394/Vp7fIwLnpvzmtNawDp0z6Xjb5aMuJSF1O/6INjmR2PUxlwfOIqh%2BjvMUFidFhV5qaEV0O/4IY1gIhhxDB4pxsg3xhAxhY1T2mZ%2BrMGVE%2BeZ8FFYOTRmFGdNHqEzBoVkf7E0rOfvMbkfI17v7x6lCPaWeaBBnbu2BHAf5aHD42C%2BoQ9I1l%2Bsf6%2B6YDjVL8ccA69juchAN5OM8/G9dZHL9uZb%2BMrZK83BAaPEZaH6GbkBwSvQxaYKm332uO9mdjejs/A5cwhtvvvQ9MqpSYQiJkKt4M/ZPeOtveeL7o7c/kv788/n80VtvK2/JestvvfVP1HykV/7oTefoj6R/9Lb89ssf6fPR26/v%2Bm/8f/9Etcx%2BNNoH16VwZ/akbfHx1PZAlAmKn2y48e36HoDvOikrAM4SinpwRaxtmxEC8olJKdmPhoWn/YS3/ia%2B0C1ZhtWVRpuhWQHYBbkNYIQyUXOOcCqr1tfej%2BC4CEvgtXCzZ5IyekZPGgngS/%2BIfk98jsJ0t4%2B9USH5cXt4rs2OR5AsITBt54lDUc7qFGuOxMv5GTwIyMPhudhv5Al3sHY5X/1kCtA20BdxT27X7XHBHQ9CjTc40chElpdBdG06RLUyY6K6ugTP%2BBPe%2Brt0e3K30gyLq4AcvyJc1lNUhmwAApLHXQMA625%2BBj5flJC4M/h7tKvODFOZXSDZ7pkRr0zhMs6be%2BOIPavs8DhK%2By9imlbH0vQq/rIogUluWmx6N95jzSaIlDnciih/LD/buBKb2af%2BMi1opVqZ9/0nvPW38deIURYm9JBGmutEkgAh4yIAOoz1TrUwPdx9PyJ1DPl4olmEefiQOgohBkMb7hiku8Qx8u389ZfEET0oQjNA8i3UjLccNz7mTVRpVZGkRendcdyoAoxrT1/76JoTaBrWAkS7CAEnqukfu3U0V8cRYgG9SQ5Lc4Dy4WjTqGyIoX/MAA1kUqxmuDiO0yx7sx/OGBaosHvr%2BEHoNqNHHe4pe/4iYe%2BNoyLWeBw1GW24DuPaDThaM37yU7UfKVWbXK7vobW2xz%2BjOcuAMgaVx3iElxCn4Zqdo4be3oCb4zjAZwrnycA5xh2hBVgWNH6Kt9uw7jFtNrfjjwgdM4/b4tQ12cfmqiPGpz8Cf0QqwA1pXY4/FtjB3cR8/AoNvdBzzCtrC2nCpqlu6Okmxqvz0ckxJgiz9VeuuY6p2p7eET2%2Bpqri0sxie3WdoUs880lmiEPj46HcAEJbjASahu5H9hGW%2BvL5%2BtHhHg0fiyrUh6eRG/DHUYoILzJOZgqf2/FHZ/b%2BHnQcjlouYmagNQ/6cZWq0lZZIPYz3c/NcaT1xnwpFD0gZhJtOeqyKZplvA2M2BRwISTo3Xs%2BhJbWOTsmpjAZ7fqw11iOzqR9nEgHCj%2B2pIvjGJcSIg/3wUnIViRykZ0VG2j67O%2BZClIHPrs7HyU3CY4YaWplT%2BNIuR4kgaIH%2BTO68GJqB6e8Nh//I%2BndSm/pH%2BmjD5X5E%2Bn1571S/OePPu%2B8%2Bqn10dv6yG%2B/kuiPpLc%2Bn4%2BSKD/nrf/lr1Y1tbfu4%2BsPBYg6bFBHdKKZ6MdeMpKaVKJr81FtkNHPX7QZEZcMthp%2B2iaTQx1luJtVmQaJ1c33IzXkTHjVRHxbN7G2cGUdiVmBwqlAfmZsXV5n8HbAXvkgkoifNgtWipGc%2BixdgPcu%2Bvu5G%2B6tM2qDliIa%2BFN6boo0vPawcoYajd5%2B%2Bsxj3Lzcfy0lOLpOSx5tr5kqNnykk5vhQ4rAHz38EUrhdn04dQTHVsmvNFyPDlcjnCI7FuaA06N97JEDXB3HEQcpqUkIQXfRq5hVM9MvQybIx/VKPZ%2Bh7uZzPfzhQJHyLsjU%2BNc3Zc/CAD7k/ZOhZ9alu%2BuMIkCv00qSmTQ39ENq5NgT6nZdjmefa7ghL9elFAxX4xcC3w/vJamYD49qChsncZTxI2VOuat512kbzyYPbrsUah%2BnNQQXqITr/fXs/JHI07v9rtu6hXpnWjPmGMQ/4I9HWipUZ2Tj7kZWpkR35%2BNUe8SzU5AW7iXCjqCaBJ24eVstMIkcvutyPNxQMuRi%2BE5KdUZFIfFroWWljZKIoDXx8879T3jr7%2BJnQkUJR7an4%2BkshfyfFoaUoyD1s2Vq3DfV5uY4TneLw9Dw0Ujw2FSxwpyjEI89fXghvGVEGLm8D6ePwdHlVOgbzXqFmJrdVMN4cCshy1XOdrPzpJ/w1t/lV9guIyOjwLk1JY%2Bmi5pI90C3Abwts06/UvTeOPaYCIsgt%2BhxTQWWpujDhi3hWah6PofVgYVSN8eRxUaYDlKhw0N64lM%2BhNweNIhPr2t0NmOTyxfHUSARc/5zARqhGXHDsQAUuZYx42foHxf53M3P0PJEj0FOngw3PWz2cs1ai4n6VodjDMPh3b4PULNnJcXUPrNs4hzG4kp3tNTMRkKTjkFAdXUcOyU9Yw3Rg4V9pHma93pq/BVnPjnt46J%2BbxwrF/imB80JPbkyOnCrzRhudg9Cc49cKFjw3bwrIgAlomFcEWfuliSG7WFArK2Iwk2qkdj4a27Oxwi4m4Yb2USK/EzNbEoekIaLEG0ay6RCOsaIWX7CW3/T/SiNlIFCzeSMxceuYJoT12XmtPYEpWh7NqffnI94ZOKvLUiG0QodUDC%2BoY1Ct7vdH5HZ%2BgPBeLlfYfMKfkEjBqgzZBJLpnUoxPbwD2mPDnJzzt19D8DEvG%2BErwLK7ZItAp48vjkmnxjzq06tydV4ODL6SSMGPBZ5QIrlGl9IelBvmkywXSiHwDvenI%2Bqj3eL9oZ7MlyOQU56dFMtgHknoUoQpGhajIvjCNPyRbioZcdCU0UR1QfYHNnU7sXsbgT/oVu6OI7UWTkKUvl4elFlhpDM1a6AnzHmDOGgpPd2XUoYCr%2B2D0qDedIKHU/X%2BGTOkE3YHZvjirb95jgytWgEK7dlUJalEDVISqEW7G03SzQrsR59yt3n2ppji5Ywh4%2BOJryFvcEvN4OXMNwkbjUc/e46I2j9bKHRE0/2PtaML63891A46FYSZJiay/ebDUGMDcxDs0NEscbJoo9EkzIkyDN3jcf23F4/4a2/zT%2BDQCLrbRCSoQSA5GcKp3HE3oHWAigc59Lt96OiY9McH8PQRx8kD73w%2Bh8XbGPzDbZNdyPjxXGsZtCEr35a7onsYxelHnxWNhcyVw8DbtgHcvO5Lms6FOfEUJv9Zv%2BAlGXnlOZvgNUa2cU3e7ee4pAvtNVlGmykxAonnDQsQvucESh5xsNU19%2BPlsdTAY2BNlYjsVE0Q1i3UpCunHLdVEdjenk%2BtsLjSg0R16N9JKMLKs4vTjq9tyeCBnu8XB%2Bezhs4o9bkEYWBKbM1tCoIGoP2UfkE/vrZK/AT3vq7/ArT0gp9hHBWj/R/DHMOWiBgX%2B5HKhL443DLn/DW36U3s5Cd4L5EDs5EiDWzdSG0NHAnkSQd7JdNFrq7f2ynTInsLCaMfOGoZ8P2CDD/HVz4MXCiq3kuSWY/Ra2zwWeGpMpMLM6IbMU%2BIgCbU30%2BcDn%2BCNcHqMO%2Bo%2BBZAPjeZJh0iFA2X/PvyKjI1at5BSME9xYBGOt6G4SjgLhDdbexB9dCBbZxxOU37%2B9ZHFGXIdBB8dPVE9EvAkMggaYYddsWJsWFabw9H5%2BZWo1HdgUxBb45WkWReACSQJNFAUmHdHUfjoaH7g/UAU8HSWhsCZ18iqacS2B2mw3kCE4vjqPEgsxhZ2LzxEY9/b0lBceW4RBUQAsvhWVfPM%2B8%2Bi8/8PMT3vr3ib9P/H3i7xP/56//AqEWL2uD%2BoLhAAAAAElFTkSuQmCC) and using "**Parse QR Code**", we get:

```
\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00'\x00\x00\x00'\x01\x00\x00\x00\x00\xa4\xd8l\x98\x00\x00\x00\xf5IDATx\x9c\x01\xea\x00\x15\xff\x01\xff\x00\x00\x00\xff\x00\x80\xa2\xd9\x1a\x02\x00\xbe\xe6T~\xfa\x04\xe4\xff\x0fh\x90\x02\x00\x1a\x7f\xdc\x00\x02\x00\xde\x01H\x00\x00\xbe\xd5\x95J\xfa\x04\xc2*\x15`\x08\x00\xff\x9d.\x9f\xfe\x04\xfd#P\xc3\x0b\x02\x97\x0e:\x07d\x04/vIg\x19\x00\xbb\xcd\xf3-\xd2\x02\xfb\xd6d\xb5\x88\x02E\xc7^\xdf\xfc\x00\x84\xfb\x13\xf3J\x02\xfd\x88a\xefD\x00\xc8t$\x90\n\x01\xc7\x01\xee1\xf7\x043Q\x17\x0cH\x01\xa5\x03\x1c6d\x02\r\xf0\xbfV$\x00\xcf\x13d3\x06\x01\xee\x08J\xf5E\x00\x9b\xee\n\xac\xfa\x01\xea|\xf2\xe86\x04\xb3\xc9\x84\xf7\xb4\x02\t\x90U%\x14\x00\xbf g\xa5\xee\x02\xfbH\xf1#4\x00\xff\xa1!;\x86\x02\x81VB\xdf\xfc\x04>\xb1s\x00\x10\x02\xe4>\xab-p\x00\xa2\xc6\xfe\xf6\xee\x04\x00\x05\xcbl5\x02\x1c\xfc\x85;\xd0\x02\xc2\xfb\xe6A\x00\x01\xff\x00\x00\x00\xff\xf9\xdb_g\xf4\x9a\xddH\x00\x00\x00\x00IEND\xaeB`\x82
```

Parsing this as a PNG results in another QR Code which contains the flag:

![[huntress/2024/images/Pasted image 20241001211641.png]]

```
flag{01c6e24c48f48856ee3adcca00f86e9b}
```

-----

Python script to take byte sequence from `qrcode.png`, writes it to a file, `output.png`, and opens it.

```python
# Byte sequence as a string
byte_string = b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00'\x00\x00\x00'\x01\x00\x00\x00\x00\xa4\xd8l\x98\x00\x00\x00\xf5IDATx\x9c\x01\xea\x00\x15\xff\x01\xff\x00\x00\x00\xff\x00\x80\xa2\xd9\x1a\x02\x00\xbe\xe6T~\xfa\x04\xe4\xff\x0fh\x90\x02\x00\x1a\x7f\xdc\x00\x02\x00\xde\x01H\x00\x00\xbe\xd5\x95J\xfa\x04\xc2*\x15`\x08\x00\xff\x9d.\x9f\xfe\x04\xfd#P\xc3\x0b\x02\x97\x0e:\x07d\x04/vIg\x19\x00\xbb\xcd\xf3-\xd2\x02\xfb\xd6d\xb5\x88\x02E\xc7^\xdf\xfc\x00\x84\xfb\x13\xf3J\x02\xfd\x88a\xefD\x00\xc8t$\x90\n\x01\xc7\x01\xee1\xf7\x043Q\x17\x0cH\x01\xa5\x03\x1c6d\x02\r\xf0\xbfV$\x00\xcf\x13d3\x06\x01\xee\x08J\xf5E\x00\x9b\xee\n\xac\xfa\x01\xea|\xf2\xe86\x04\xb3\xc9\x84\xf7\xb4\x02\t\x90U%\x14\x00\xbf g\xa5\xee\x02\xfbH\xf1#4\x00\xff\xa1!;\x86\x02\x81VB\xdf\xfc\x04>\xb1s\x00\x10\x02\xe4>\xab-p\x00\xa2\xc6\xfe\xf6\xee\x04\x00\x05\xcbl5\x02\x1c\xfc\x85;\xd0\x02\xc2\xfb\xe6A\x00\x01\xff\x00\x00\x00\xff\xf9\xdb_g\xf4\x9a\xddH\x00\x00\x00\x00IEND\xaeB`\x82"

# Write the bytes to a file
with open("output.png", "wb") as f:
    f.write(byte_string)

# Display the image using PIL (Pillow)
from PIL import Image

# Open and display the image
img = Image.open("output.png")
img.show()

```