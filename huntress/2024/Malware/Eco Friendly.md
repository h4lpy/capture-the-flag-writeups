# Eco Friendly



-----



```python
with open("eco-friendly", 'r') as f:
    data = f.read()

mapping = {
    "$env:ProgramData": "C:\\ProgramData",
    "$env:ProgramFiles": "C:\\Program Files",
    "$env:HOMEDRIVE": "C:",
    "$env:CommonProgramFiles": "C:\\Program Files\\Common Files",
    "$env:ALLUSERSPROFILE": "C:\\ProgramData",
    "$env:ComSpec": "C:\\Windows\\System32\\cmd.exe",
    "$env:PUBLIC": "C:\\Users\\Public",
    "$env:windir": "C:\\Windows",
    "$env:CommonProgramW6432": "C:\\Program Files\\Common Files",
    "$env:SystemRoot": "C:\\Windows",
    "$env:PATHEXT": ".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.PY;.PYW",
    "$env:SystemDrive": "C:"
}


def replace_malformed_env_vars(text, mappings):
    # Loop through the mapping dictionary
    for malformed, correct in mappings.items():
        # Replace occurrences of the malformed environment variable with the correct one
        text = text.replace(malformed, correct)
    return text


malformed_mappings = {
    '$env:YATHEXT': '$env:PATHEXT',
    '$env:PommonYrogramFiles': '$env:CommonProgramFiles',
    '$env:HOMEDRiVE': '$env:HOMEDRIVE',
    '$env:A;;USERsPRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:PommonProgramFiles': '$env:CommonProgramFiles',
    '$env:A;;UsERSYRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:A;;UsERsYROFi;E': '$env:ALLUSERSPROFILE',
    '$env:Programdata': '$env:ProgramData',
    '$env:A;;USERSPRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:A;;UsERsPROFi;E': '$env:ALLUSERSPROFILE',
    '$env:systemRoot': '$env:SystemRoot',
    '$env:PUB;iC': '$env:PUBLIC',
    '$env:syStemDrive': '$env:SystemDrive',
    '$env:syStemRoot': '$env:SystemRoot',
    '$env:A;;USERSPROFi;E': '$env:ALLUSERSPROFILE',
    '$env:ProgramFileS': '$env:ProgramFiles',
    '$env:HoMEDRiVE': '$env:HOMEDRIVE',
    '$env:SystemRoot': '$env:SystemRoot',
    '$env:A;;UsERsYRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:CommonYrogramw6432': '$env:CommonProgramW6432',
    '$env:systemDrive': '$env:SystemDrive',
    '$env:CommonProgramw6432': '$env:CommonProgramW6432',
    '$env:A;;UsERSYROFi;E': '$env:ALLUSERSPROFILE',
    '$env:PommonProgramW6432': '$env:CommonProgramW6432',
    '$env:PomSpec': '$env:ComSpec',
    '$env:CommonProgramFiles': '$env:CommonProgramFiles',
    '$env:PommonProgramFileS': '$env:CommonProgramFiles',
    '$env:Comspec': '$env:ComSpec',
    '$env:PommonYrogramw6432': '$env:CommonProgramW6432',
    '$env:YrogramData': '$env:ProgramData',
    '$env:CommonProgramFileS': '$env:CommonProgramFiles',
    '$env:YUB;iP': '$env:PUBLIC',
    '$env:SystemDrive': '$env:SystemDrive',
    '$env:A;;UsERsPRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:CommonYrogramFileS': '$env:CommonProgramFiles',
    '$env:YrogramFileS': '$env:ProgramFiles',
    '$env:Yrogramdata': '$env:ProgramData',
    '$env:PUB;iP': '$env:PUBLIC',
    '$env:A;;USERsYRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:ComSpec': '$env:ComSpec',
    '$env:PATHEXT': '$env:PATHEXT',
    '$env:Pomspec': '$env:ComSpec',
    '$env:CommonYrogramW6432': '$env:CommonProgramW6432',
    '$env:HOMEdRiVE': '$env:HOMEDRIVE',
    '$env:A;;UsERSPROFi;E': '$env:ALLUSERSPROFILE',
    '$env:A;;USERSYROFi;E': '$env:ALLUSERSPROFILE',
    '$env:A;;USERSYRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:A;;USERsPROFi;E': '$env:ALLUSERSPROFILE',
    '$env:HoMEdRiVE': '$env:HOMEDRIVE',
    '$env:windir': '$env:windir',
    '$env:CommonProgramW6432': '$env:CommonProgramW6432',
    '$env:SyStemRoot': '$env:SystemRoot',
    '$env:PommonYrogramW6432': '$env:CommonProgramW6432',
    '$env:YUB;iC': '$env:PUBLIC',
    '$env:systemdrive': '$env:SystemDrive',
    '$env:YrogramFiles': '$env:ProgramFiles',
    '$env:SyStemdrive': '$env:SystemDrive',
    '$env:PommonProgramw6432': '$env:CommonProgramW6432',
    '$env:Systemdrive': '$env:SystemDrive',
    '$env:ProgramData': '$env:ProgramData',
    '$env:A;;UsERSPRoFi;E': '$env:ALLUSERSPROFILE',
    '$env:CommonYrogramFiles': '$env:CommonProgramFiles',
    '$env:A;;USERsYROFi;E': '$env:ALLUSERSPROFILE'
}

def find_this_shit(data):
    data = replace_malformed_env_vars(data, malformed_mappings)

    values, indices = data.split(" -f ")
    entries = list(map(int,values.lstrip("iex ('{").rstrip("}'").split("}{")))
    vals = indices.split(",")

    output = []
    for val in vals:
        if "$env" in val:
            name = val.split("[")[0]
            index = int(val.split("[")[1].split("]")[0])
            try:
                output.append(mapping.get(name)[index])
            except:
                print(f"out of range {name} and {index}")
        elif "char" in val:
            char = int(val.split("]")[1].rstrip(")"))
            output.append(chr(char))

    out = []
    for entry in entries:
        try:
            out.append(output[entry])
        except:
            print(f"looking for {entry} and failed")

    return "".join(out)


while True:
    data = find_this_shit(data)
    if "flag{" in data:
        print(data)
        break
```